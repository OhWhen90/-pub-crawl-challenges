<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pub Crawl Challenge List</title>

  <!-- Styles for layout, typography, and elements -->
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      max-width: 600px;
      margin: 0 auto;
      padding: 1rem;
      background: #f9f9f9;
      color: #222;
    }

    h1 {
      text-align: center;
      margin-bottom: 1rem;
    }

    /* Each challenge label is a flex container to align checkbox and content */
    label {
      display: flex;
      align-items: flex-start;
      padding: 0.5rem 0;
      font-size: 1.1rem;
      cursor: pointer;
    }

    /* Larger checkboxes for easier tapping on mobile */
    input[type="checkbox"] {
      margin-right: 1rem;
      transform: scale(1.3);
    }

    /* Emoji style next to each challenge */
    .emoji {
      margin-right: 0.3rem;
      font-size: 1.3rem;
    }

    /* Challenge title style */
    .challenge-title {
      font-weight: 700;
    }

    /* Challenge description style */
    .challenge-desc {
      margin-left: 2.7rem;
      font-weight: 400;
      color: #555;
      font-size: 0.95rem;
      margin-top: -0.3rem;
    }

    /* Bonus and rainbow color checkboxes container style */
    .bonus, .rainbow {
      margin-left: 2.7rem;
      font-size: 0.85rem;
      color: #444;
    }

    /* Smaller checkboxes for bonuses and rainbow colors */
    .bonus input[type="checkbox"], .rainbow input[type="checkbox"] {
      transform: scale(1.1);
      margin-right: 0.4rem;
    }

    /* Rainbow color checkboxes arranged inline in two columns */
    .rainbow label {
      display: inline-block;
      width: 48%;
      margin-top: 0.3rem;
    }
  </style>
</head>

<body>
  <h1>Pub Crawl Challenge List</h1>

  <!-- Container where challenges will be dynamically added -->
  <div id="challenge-container"></div>

  <!-- Score display section -->
  <div style="text-align: center; margin-top: 2rem; font-size: 1.1rem;">
    <div id="main-count">‚úîÔ∏è Challenges Completed: 0 / 10</div>
    <div id="bonus-count">‚≠ê Bonus Points Earned: 0 / 10</div>
    <div id="total-score">üèÜ Total Score: 0 / 20</div>
  </div>

  <script>
    // -------------------
    // Data for each challenge
    // -------------------
    const challenges = [
      {
        id: 0,
        emojis: ["üîÅ", "üëï"],
        title: "Closet Shuffle.",
        desc: "Swap an item of clothing with someone for the entire time at one location."
      },
      {
        id: 1,
        emojis: ["üåà", "üçπ"],
        title: "Taste the Rainbow.",
        desc: "Drink two different colours of the rainbow ‚Äî use cocktails, shots, or even mixers.",
        rainbow: true  // special challenge with color tracking
      },
      {
        id: 2,
        emojis: ["ü•§", "üç∏"],
        title: "The Diana Special.",
        desc: "Finish your entire drink using three (or more) straws at once."
      },
      {
        id: 3,
        emojis: ["üîô", "üö∂‚Äç‚ôÇÔ∏è"],
        title: "Backwards Journey.",
        desc: "Walk backwards between any two crawl stops. Safety first, though ‚Äî have a guide!"
      },
      {
        id: 4,
        emojis: ["üß¶", "‚úã"],
        title: "Sock Puppet Hour.",
        desc: "Wear a sock on your right hand for the entire time at one location. Introduce it as your new drinking buddy."
      },
      {
        id: 5,
        emojis: ["üï∫", "üíÉ"],
        title: "Dance-Off Destiny.",
        desc: "Join or start a dance-off.",
        bonus: "If you win or get strangers to cheer."
      },
      {
        id: 6,
        emojis: ["ü§´", "üìé"],
        title: "The Sneaky Peg.",
        desc: "Clip your peg on someone without them noticing ‚Äî it must stay there for 15 minutes. Proof required!",
        bonus: "Someone leaves a crawl stop wearing your peg.",
        bonusAlwaysEnabled: true  // bonus can be ticked anytime
      },
      {
        id: 7,
        emojis: ["üé≠", "üó£Ô∏è"],
        title: "Accent Order (Encore).",
        desc: "Order your drink in a full accent (e.g. French, pirate, cowboy, Scottish).",
        bonus: "Stay in character until you have finished your drink."
      },
      {
        id: 8,
        emojis: ["üì∏", "ü§≥"],
        title: "The Hospitality Selfie.",
        desc: "Take a selfie with either a bartender or a bouncer.",
        bonus: "If they smile."
      },
      {
        id: 9,
        emojis: ["üçª", "ü•Ç"],
        title: "The Icebreaker Toast.",
        desc: "Walk up to a complete stranger (or another group) and confidently give a short but passionate toast in their honour.",
        bonus: "If they toast back."
      }
    ];

    // Rainbow color names for "Taste the Rainbow" checkboxes
    const rainbowColors = ["red", "orange", "yellow", "green", "blue", "indigo", "violet"];

    // -------------------
    // Function to create and insert all challenge elements into the DOM
    // -------------------
    function createChallenges() {
      const container = document.getElementById("challenge-container");

      challenges.forEach(ch => {
        // Create main label container for the challenge
        const label = document.createElement("label");

        // Create main challenge checkbox
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.id = `chk${ch.id}`;

        // Disable manual checking for the rainbow challenge main checkbox
        if (ch.id === 1) checkbox.disabled = true;

        label.appendChild(checkbox);

        // Append emojis for the challenge
        ch.emojis.forEach(e => {
          const span = document.createElement("span");
          span.className = "emoji";
          span.textContent = e;
          label.appendChild(span);
        });

        // Create a container for title and description
        const div = document.createElement("div");
        div.innerHTML = `
          <div class="challenge-title">${ch.title}</div>
          <div class="challenge-desc">${ch.desc}</div>`;

        // If challenge tracks rainbow colors, add checkboxes for each color
        if (ch.rainbow) {
          const colorContainer = document.createElement("div");
          colorContainer.className = "rainbow";

          rainbowColors.forEach(color => {
            colorContainer.innerHTML += `
              <label>
                <input type="checkbox" id="rainbow-${color}"> 
                ${color.charAt(0).toUpperCase() + color.slice(1)}
              </label>`;
          });

          // Add bonus info for extra colors beyond two
          colorContainer.innerHTML += `
            <div class="bonus" style="margin-top:0.3rem;">
              ‚≠ê Bonus: Each additional colour beyond two.
            </div>`;

          div.appendChild(colorContainer);
        }

        // If challenge has a bonus, add bonus checkbox and description
        if (ch.bonus) {
          const bonusContainer = document.createElement("div");
          bonusContainer.className = "bonus";

          // Bonus checkbox is disabled unless marked always enabled
          bonusContainer.innerHTML = `
            <input type="checkbox" id="chk${ch.id}b" ${ch.bonusAlwaysEnabled ? '' : 'disabled'} /> 
            ‚≠ê Bonus: ${ch.bonus}`;

          div.appendChild(bonusContainer);
        }

        // Append the challenge text container to label
        label.appendChild(div);

        // Append the full challenge label to the container
        container.appendChild(label);
      });
    }

    // -------------------
    // Function to update score counters and checkbox states
    // -------------------
    function updateScore() {
      let main = 0;  // Completed main challenges
      let bonus = 0; // Completed bonus points
      let rainbowCount = 0; // Number of rainbow colors checked

      // Count checked rainbow colors
      rainbowColors.forEach(color => {
        const cb = document.getElementById("rainbow-" + color);
        if (cb && cb.checked) rainbowCount++;
      });

      // Handle main "Taste the Rainbow" checkbox auto-check based on colors
      const rainbowMain = document.getElementById("chk1");
      if (rainbowCount >= 2) {
        rainbowMain.checked = true;
        if (rainbowCount > 2) {
          bonus += rainbowCount - 2;
        }
      } else {
        rainbowMain.checked = false;
      }

      // Count main challenges and bonuses checked
      challenges.forEach(ch => {
        const chk = document.getElementById("chk" + ch.id);
        const bchk = document.getElementById("chk" + ch.id + "b");

        if (chk && chk.checked && ch.id !== 1) {
          main++;
        }

        // Include rainbow challenge main if checked (auto-checked)
        if (ch.id === 1 && chk.checked) {
          main++;
        }

        // Count bonus only if checked AND enabled
        if (bchk && bchk.checked && !bchk.disabled) {
          bonus++;
        }
      });

      // Update text counters in the UI
      document.getElementById("main-count").textContent = `‚úîÔ∏è Challenges Completed: ${main} / 10`;
      document.getElementById("bonus-count").textContent = `‚≠ê Bonus Points Earned: ${bonus} / 10`;
      document.getElementById("total-score").textContent = `üèÜ Total Score: ${main + bonus} / 20`;

      // Enable or disable bonus checkboxes based on main checkbox state
      challenges.forEach(ch => {
        if (ch.bonus && !ch.bonusAlwaysEnabled) {
          const mainChk = document.getElementById("chk" + ch.id);
          const bonusChk = document.getElementById("chk" + ch.id + "b");
          if (!mainChk.checked) {
            bonusChk.checked = false;
            bonusChk.disabled = true;
          } else {
            bonusChk.disabled = false;
          }
        }
      });
    }

    // -------------------
    // DOMContentLoaded - initialize app
    // -------------------
    document.addEventListener("DOMContentLoaded", () => {
      createChallenges();

      // Load saved checkbox states from localStorage
      document.querySelectorAll("input[type=checkbox]").forEach(cb => {
        const saved = localStorage.getItem("pubcrawl-" + cb.id);
        if (saved === "true") cb.checked = true;
      });

      // Initial score update
      updateScore();

      // Add event listeners to checkboxes to save state and update scores
      document.querySelectorAll("input[type=checkbox]").forEach(cb => {
        cb.addEventListener("change", () => {
          localStorage.setItem("pubcrawl-" + cb.id, cb.checked);
          updateScore();
        });
      });
    });
  </script>
</body>
</html>
